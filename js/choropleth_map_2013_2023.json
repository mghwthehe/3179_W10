{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Live Birth Rate per 1,000 People (2013-2023)",
  "width": "container",
  "height": 360,
  "autosize": {"type": "fit", "contains": "padding"},
  "projection": {"type": "mercator", "center": [110, 3.8], "scale": 1370},
  "params": [
    {
      "name": "yr",
      "value": 2023,
      "bind": {"input": "range", "min": 2013, "max": 2023, "step": 1, "name": "Year: "}
    }
  ],

  "layer": [
    {
      "data": {
        "url": "https://raw.githubusercontent.com/FIT3179/Vega-Lite/main/7_others/oceans.topojson",
        "format": {"type": "topojson", "feature": "oceans"}
      },
      "mark": {"type": "geoshape", "fill": "#cce5ff"}
    },
    {
      "data": {"graticule": {"step": [1, 1]}},
      "mark": {"type": "geoshape", "stroke": "darkgrey", "strokeWidth": 1, "opacity": 0.6}
    },
    {
      "data": {"url": "data/choropleth_map_2013_2023.csv"},
      "transform": [
        {"filter": "datum.year == yr"},
        {
          "lookup": "state",
          "from": {
            "data": {
              "url": "js/ne_10m_admin_1_states_provinces.topojson",
              "format": {"type": "topojson", "feature": "ne_10m_admin_1_states_provinces"}
            },
            "key": "properties.state"
          },
          "as": "geo"
        }
      ],
      "mark": {"type": "geoshape"},
      "encoding": {
        "shape": {"field": "geo", "type": "geojson"},
        "color": {
          "field": "birth_rate_per_1000",
          "type": "quantitative",
          "title": "Births per 1,000",
          "scale": {"scheme": "greens"}
        },
        "tooltip": [
          {"field": "state", "type": "nominal", "title": "State"},
          {"field": "year", "type": "ordinal", "title": "Year"},
          {"field": "birth_rate_per_1000", "type": "quantitative", "format": ".2f", "title": "Birth Rate per 1000 people"}
        ]
      }
    },
    {
      "data": {
        "url": "js/ne_10m_admin_1_states_provinces.topojson",
        "format": {"type": "topojson", "feature": "ne_10m_admin_1_states_provinces"}
      },
      "mark": {"type": "geoshape", "fill": null, "stroke": "#334155", "strokeWidth": 0.8}
    }
  ],
  "config": {
    "legend": {"orient": "bottom", "gradientLength": 160},
    "view": {"stroke": null}
  }
}

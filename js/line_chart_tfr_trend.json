{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Total Fertility Rate (TFR) by State, 2013-2023",
  "width": "container",
  "height": 360,
  "autosize": { "type": "fit", "contains": "padding" },
  "data": { "url": "data/line_chart_tfr_trend_2013_2023.csv" },
  "params": [
    {
      "name": "stateSel",
      "value": null,
      "bind": {
        "input": "select",
        "options": [null,
          "Johor","Kedah","Kelantan","Melaka","Negeri Sembilan","Pahang",
          "Perak","Perlis","Pulau Pinang","Sabah","Sarawak","Selangor",
          "Terengganu","W.P. Kuala Lumpur","W.P. Labuan","W.P. Putrajaya"
        ],
        "labels": ["(All States)",
          "Johor","Kedah","Kelantan","Melaka","Negeri Sembilan","Pahang",
          "Perak","Perlis","Pulau Pinang","Sabah","Sarawak","Selangor",
          "Terengganu","W.P. Kuala Lumpur","W.P. Labuan","W.P. Putrajaya"
        ],
        "name": "State: "
      }
    }
  ],
  "transform": [
    { "filter": "stateSel == null || datum.state == stateSel" }
  ],
  "layer": [
    {
      "mark": { "type": "line", "strokeWidth": 2 },
      "encoding": {
        "x": {
          "field": "date", "type": "temporal", "timeUnit": "year",
          "title": "Year", "axis": { "format": "%Y", "tickCount": 11 }
        },
        "y": {
          "field": "tfr", "type": "quantitative",
          "title": "Total Fertility Rate (TFR)", "scale": { "nice": true }
        },
        "color": {
          "field": "state",
          "type": "nominal",
          "title": "State",
          "legend": { "symbolLimit": 30, "symbolStrokeWidth": 3.5 },
          "scale": {
            "domain": [
              "Johor","Kedah","Kelantan","Melaka","Negeri Sembilan","Pahang", "Perak","Perlis","Pulau Pinang","Sabah","Sarawak","Selangor", "Terengganu","W.P. Kuala Lumpur","W.P. Labuan","W.P. Putrajaya"
            ]
          }
        },
        "tooltip": [
          { "field": "state", "title": "State" },
          { "field": "date", "type": "temporal", "timeUnit": "year", "title": "Year" },
          { "field": "tfr", "type": "quantitative", "format": ".2f", "title": "TFR" }
        ]
      }
    },
    {
  "mark": { "type": "rule", "color": "#201514", "strokeDash": [5,3], "strokeWidth": 1 },
  "encoding": { "y": { "datum": 2.1 } }
},
    {
    "mark": {
        "type": "text",
        "text": "Replacement fertility level (2.1)",
        "align": "center",
        "dx": 0,
        "dy": -8,
        "color": "#201514",
        "fontSize": 8
    },
    "encoding": {
        "y": { "datum": 2.1 },
        "x": { 
            "datum": {"year": 2019},
            "type": "temporal"
        } 
    }
    }
  ],
  "config": { "view": { "stroke": null } }
}
